# Disable Automatic Audio Switching to HDMI/DisplayPort Outputs
#
# PURPOSE:
# This configuration prevents WirePlumber from automatically switching audio
# output to HDMI/DisplayPort when external monitors are connected via USB-C or HDMI.
#
# PROBLEM:
# By default, when connecting a monitor (especially via USB-C), WirePlumber
# automatically switches audio to the monitor's speakers if available. This causes
# audio to stop playing through laptop speakers/headphones, which is often undesired.
#
# SOLUTION:
# This rule matches all HDMI and DisplayPort audio outputs and sets their priority
# to 0, preventing them from being automatically selected as the default audio sink.
# The laptop's built-in speakers/headphone jack will remain the default output.
#
# BEHAVIOR AFTER APPLYING:
# - Connecting monitors via USB-C/HDMI will NOT switch audio automatically
# - Laptop speakers/headphones remain the default audio output
# - You can still manually switch to monitor audio if desired using audio controls
#
# HOW IT WORKS:
# WirePlumber uses priority values to determine which audio sink should be the
# default. Higher priority = more likely to be selected as default. By setting
# HDMI/DP priority to 0, we ensure they're never auto-selected.

monitor.alsa.rules = [
  {
    matches = [
      {
        # Match any HDMI output
        node.name = "~alsa_output.*HDMI.*"
      }
      {
        # Match any DisplayPort output
        node.name = "~alsa_output.*DP.*"
      }
    ]
    actions = {
      update-props = {
        # Set priority to 0 to prevent auto-selection
        priority.session = 0
      }
    }
  }
]
